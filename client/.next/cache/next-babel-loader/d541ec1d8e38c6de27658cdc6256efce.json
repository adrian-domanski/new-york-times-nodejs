{"ast":null,"code":"var _jsxFileName = \"C:\\\\SandBox\\\\next-articles\\\\client\\\\pages\\\\login.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from \"react\";\nimport Layout from \"../components/layout\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { loginQuery } from \"../queries/authQueries\";\nimport { AuthContext } from \"../context/authContext\";\nimport { useRouter } from \"next/router\";\n\nconst Login = () => {\n  const {\n    0: email,\n    1: setEmail\n  } = useState(\"john@gmail.com\");\n  const {\n    0: password,\n    1: setPassword\n  } = useState(\"john123\");\n  const {\n    0: emailError,\n    1: setEmailError\n  } = useState(\"\");\n  const {\n    0: passwordError,\n    1: setPasswordError\n  } = useState(\"\");\n  const {\n    0: alert,\n    1: setAlert\n  } = useState(\"\");\n  const {\n    refetch: login\n  } = useQuery(loginQuery, {\n    skip: true\n  });\n  const {\n    0: alertTimeOut,\n    1: setAlertTimeOut\n  } = useState();\n  const {\n    authContext: {\n      isAuth\n    },\n    dispatch: authDispatch\n  } = useContext(AuthContext);\n  const router = useRouter();\n  useEffect(() => {\n    if (isAuth) {\n      router.push(\"/articles\");\n    }\n  }, [isAuth]);\n  useEffect(() => {\n    return () => {// clearTimeout(alertTimeOut);\n    };\n  });\n\n  const handleValidateEmail = email => {\n    const re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n    if (!re.test(email)) {\n      return setEmailError(\"Email must have @ and .\");\n    } // No error\n\n\n    setEmailError(\"\");\n  };\n\n  const handleValidatePassword = password => {\n    if (password.length < 3) {\n      return setPasswordError(\"Password must have at least 3 chars\");\n    } // No error\n\n\n    setPasswordError(\"\");\n  };\n\n  const showAlert = msg => {\n    setAlert(msg); // Clear alert\n\n    setAlertTimeOut(setTimeout(() => {\n      setAlert(\"\");\n    }, 5000));\n  };\n\n  const handleChange = ({\n    target: {\n      value,\n      name\n    }\n  }) => {\n    switch (name) {\n      case \"email\":\n        handleValidateEmail(value);\n        return setEmail(value);\n\n      case \"password\":\n        handleValidatePassword(value);\n        return setPassword(value);\n\n      default:\n        return null;\n    }\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    try {\n      const {\n        data\n      } = await login({\n        password,\n        email\n      });\n      authDispatch({\n        type: \"LOGIN_SUCCESS\",\n        payload: data.login\n      });\n    } catch (err) {\n      if (err.graphQLErrors) {\n        showAlert(err.graphQLErrors[0].message);\n      } else {\n        console.log(err);\n      }\n    }\n  };\n\n  return __jsx(Layout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"login-page container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"login-page-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"login-page__title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, \"Log in\"), __jsx(\"div\", {\n    className: \"login-page__info\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, \"To begin your journey with the New York Times Articles, please authenticate yourself.\"), __jsx(\"form\", {\n    onSubmit: e => {\n      handleSubmit(e);\n    },\n    className: \"login-page__form\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, alert ? __jsx(\"div\", {\n    className: \"login-alert\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, alert, __jsx(\"button\", {\n    onClick: () => setAlert(\"\"),\n    className: \"alert-close\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-times\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }))) : null, __jsx(\"div\", {\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: `input-error ${emailError ? \"active\" : \"\"}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, emailError), __jsx(\"input\", {\n    type: \"email\",\n    name: \"email\",\n    className: \"login-form__input\",\n    value: email,\n    onChange: handleChange,\n    placeholder: \"Email...\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: `input-error ${passwordError ? \"active\" : \"\"}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, passwordError), __jsx(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    value: password,\n    className: \"login-form__input\",\n    onChange: handleChange,\n    placeholder: \"Password...\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  })), __jsx(\"input\", {\n    type: \"submit\",\n    disabled: passwordError || emailError ? true : false,\n    className: \"btn btn--submit\",\n    value: \"Log In\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  })))));\n};\n\nexport default Login;","map":{"version":3,"sources":["C:/SandBox/next-articles/client/pages/login.js"],"names":["React","useState","useContext","useEffect","Layout","useQuery","loginQuery","AuthContext","useRouter","Login","email","setEmail","password","setPassword","emailError","setEmailError","passwordError","setPasswordError","alert","setAlert","refetch","login","skip","alertTimeOut","setAlertTimeOut","authContext","isAuth","dispatch","authDispatch","router","push","handleValidateEmail","re","test","handleValidatePassword","length","showAlert","msg","setTimeout","handleChange","target","value","name","handleSubmit","e","preventDefault","data","type","payload","err","graphQLErrors","message","console","log"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\r\nimport Layout from \"../components/layout\";\r\nimport { useQuery } from \"@apollo/react-hooks\";\r\nimport { loginQuery } from \"../queries/authQueries\";\r\nimport { AuthContext } from \"../context/authContext\";\r\nimport { useRouter } from \"next/router\";\r\n\r\nconst Login = () => {\r\n  const [email, setEmail] = useState(\"john@gmail.com\");\r\n  const [password, setPassword] = useState(\"john123\");\r\n  const [emailError, setEmailError] = useState(\"\");\r\n  const [passwordError, setPasswordError] = useState(\"\");\r\n  const [alert, setAlert] = useState(\"\");\r\n  const { refetch: login } = useQuery(loginQuery, { skip: true });\r\n  const [alertTimeOut, setAlertTimeOut] = useState();\r\n  const {\r\n    authContext: { isAuth },\r\n    dispatch: authDispatch\r\n  } = useContext(AuthContext);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    if (isAuth) {\r\n      router.push(\"/articles\");\r\n    }\r\n  }, [isAuth]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      // clearTimeout(alertTimeOut);\r\n    };\r\n  });\r\n\r\n  const handleValidateEmail = email => {\r\n    const re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    if (!re.test(email)) {\r\n      return setEmailError(\"Email must have @ and .\");\r\n    }\r\n    // No error\r\n    setEmailError(\"\");\r\n  };\r\n\r\n  const handleValidatePassword = password => {\r\n    if (password.length < 3) {\r\n      return setPasswordError(\"Password must have at least 3 chars\");\r\n    }\r\n\r\n    // No error\r\n    setPasswordError(\"\");\r\n  };\r\n\r\n  const showAlert = msg => {\r\n    setAlert(msg);\r\n\r\n    // Clear alert\r\n    setAlertTimeOut(\r\n      setTimeout(() => {\r\n        setAlert(\"\");\r\n      }, 5000)\r\n    );\r\n  };\r\n\r\n  const handleChange = ({ target: { value, name } }) => {\r\n    switch (name) {\r\n      case \"email\":\r\n        handleValidateEmail(value);\r\n        return setEmail(value);\r\n      case \"password\":\r\n        handleValidatePassword(value);\r\n        return setPassword(value);\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n    try {\r\n      const { data } = await login({ password, email });\r\n      authDispatch({ type: \"LOGIN_SUCCESS\", payload: data.login });\r\n    } catch (err) {\r\n      if (err.graphQLErrors) {\r\n        showAlert(err.graphQLErrors[0].message);\r\n      } else {\r\n        console.log(err);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Layout>\r\n      <div className=\"login-page container\">\r\n        <div className=\"login-page-container\">\r\n          <h1 className=\"login-page__title\">Log in</h1>\r\n          <div className=\"login-page__info\">\r\n            To begin your journey with the New York Times Articles, please\r\n            authenticate yourself.\r\n          </div>\r\n          <form\r\n            onSubmit={e => {\r\n              handleSubmit(e);\r\n            }}\r\n            className=\"login-page__form\">\r\n            {alert ? (\r\n              <div className=\"login-alert\">\r\n                {alert}\r\n                <button onClick={() => setAlert(\"\")} className=\"alert-close\">\r\n                  <i className=\"fas fa-times\"></i>\r\n                </button>\r\n              </div>\r\n            ) : null}\r\n            <div className=\"form-control\">\r\n              <div className={`input-error ${emailError ? \"active\" : \"\"}`}>\r\n                {emailError}\r\n              </div>\r\n              <input\r\n                type=\"email\"\r\n                name=\"email\"\r\n                className=\"login-form__input\"\r\n                value={email}\r\n                onChange={handleChange}\r\n                placeholder=\"Email...\"\r\n              />\r\n            </div>\r\n            <div className=\"form-control\">\r\n              <div className={`input-error ${passwordError ? \"active\" : \"\"}`}>\r\n                {passwordError}\r\n              </div>\r\n              <input\r\n                type=\"password\"\r\n                name=\"password\"\r\n                value={password}\r\n                className=\"login-form__input\"\r\n                onChange={handleChange}\r\n                placeholder=\"Password...\"\r\n              />\r\n            </div>\r\n\r\n            <input\r\n              type=\"submit\"\r\n              disabled={passwordError || emailError ? true : false}\r\n              className=\"btn btn--submit\"\r\n              value=\"Log In\"\r\n            />\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}