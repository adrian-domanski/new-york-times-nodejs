{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\SandBox\\\\next-articles\\\\client\\\\pages\\\\register.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from \"react\";\nimport Layout from \"../components/layout\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport { registerMutation } from \"../queries/authQueries\";\nimport { AuthContext } from \"../context/authContext\";\nimport { useRouter } from \"next/router\";\n\nvar Register = function Register() {\n  var _useState = useState(\"\"),\n      email = _useState[0],\n      setEmail = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      emailError = _useState3[0],\n      setEmailError = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      passwordError = _useState4[0],\n      setPasswordError = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      alert = _useState5[0],\n      setAlert = _useState5[1];\n\n  var _useState6 = useState(),\n      alertTimeOut = _useState6[0],\n      setAlertTimeOut = _useState6[1];\n\n  var _useMutation = useMutation(registerMutation),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      register = _useMutation2[0];\n\n  var _useContext = useContext(AuthContext),\n      isAuth = _useContext.authContext.isAuth,\n      authDispatch = _useContext.dispatch;\n\n  var router = useRouter();\n  useEffect(function () {\n    if (isAuth) {\n      router.push(\"/articles\");\n    }\n  }, [isAuth]); // Clear timeout after unmount\n\n  useEffect(function () {\n    return clearTimeout(alertTimeOut);\n  });\n\n  var handleValidateEmail = function handleValidateEmail(email) {\n    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n    if (!re.test(email)) {\n      return setEmailError(\"Email must have @ and .\");\n    } // No error\n\n\n    setEmailError(\"\");\n  };\n\n  var handleValidatePassword = function handleValidatePassword(password) {\n    if (password.length < 3) {\n      return setPasswordError(\"Password must have at least 3 chars\");\n    } // No error\n\n\n    setPasswordError(\"\");\n  };\n\n  var showAlert = function showAlert(msg) {\n    setAlert(msg); // Clear alert\n\n    setTimeout(function () {\n      setAlert(\"\");\n    }, 5000);\n  };\n\n  var handleChange = function handleChange(_ref) {\n    var _ref$target = _ref.target,\n        value = _ref$target.value,\n        name = _ref$target.name;\n\n    switch (name) {\n      case \"email\":\n        handleValidateEmail(value);\n        return setEmail(value);\n\n      case \"password\":\n        handleValidatePassword(value);\n        return setPassword(value);\n\n      default:\n        return null;\n    }\n  };\n\n  var handleSubmit = function handleSubmit(e) {\n    var _ref2, data;\n\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            e.preventDefault();\n            _context.prev = 1;\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(register({\n              variables: {\n                email: email,\n                password: password\n              }\n            }));\n\n          case 4:\n            _ref2 = _context.sent;\n            data = _ref2.data;\n            authDispatch({\n              type: \"REGISTER_SUCCESS\",\n              payload: data.register\n            });\n            console.log(data);\n            _context.next = 13;\n            break;\n\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context[\"catch\"](1);\n\n            if (_context.t0.graphQLErrors) {\n              showAlert(_context.t0.graphQLErrors[0].message);\n            } else {\n              console.log(_context.t0);\n            }\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[1, 10]]);\n  };\n\n  return __jsx(Layout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"login-page container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"login-page-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"login-page__title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, \"Register\"), __jsx(\"div\", {\n    className: \"login-page__info\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, \"To begin your journey with the New York Times Articles, please authenticate yourself.\"), __jsx(\"form\", {\n    onSubmit: function onSubmit(e) {\n      handleSubmit(e);\n    },\n    className: \"login-page__form\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, alert ? __jsx(\"div\", {\n    className: \"login-alert\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, alert, __jsx(\"button\", {\n    onClick: function onClick() {\n      return setAlert(\"\");\n    },\n    className: \"alert-close\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, __jsx(\"i\", {\n    className: \"fas fa-times\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }))) : null, __jsx(\"div\", {\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"input-error \".concat(emailError ? \"active\" : \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, emailError), __jsx(\"input\", {\n    type: \"email\",\n    name: \"email\",\n    className: \"login-form__input\",\n    value: email,\n    onChange: handleChange,\n    placeholder: \"Email...\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"input-error \".concat(passwordError ? \"active\" : \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, passwordError), __jsx(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    value: password,\n    className: \"login-form__input\",\n    onChange: handleChange,\n    placeholder: \"Password...\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  })), __jsx(\"input\", {\n    type: \"submit\",\n    disabled: passwordError || emailError ? true : false,\n    className: \"btn btn--submit\",\n    value: \"Create Account\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  })))));\n};\n\nexport default Register;","map":{"version":3,"sources":["C:/SandBox/next-articles/client/pages/register.js"],"names":["React","useState","useContext","useEffect","Layout","useMutation","registerMutation","AuthContext","useRouter","Register","email","setEmail","password","setPassword","emailError","setEmailError","passwordError","setPasswordError","alert","setAlert","alertTimeOut","setAlertTimeOut","register","isAuth","authContext","authDispatch","dispatch","router","push","clearTimeout","handleValidateEmail","re","test","handleValidatePassword","length","showAlert","msg","setTimeout","handleChange","target","value","name","handleSubmit","e","preventDefault","variables","data","type","payload","console","log","graphQLErrors","message"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\r\nimport Layout from \"../components/layout\";\r\nimport { useMutation } from \"@apollo/react-hooks\";\r\nimport { registerMutation } from \"../queries/authQueries\";\r\nimport { AuthContext } from \"../context/authContext\";\r\nimport { useRouter } from \"next/router\";\r\n\r\nconst Register = () => {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [emailError, setEmailError] = useState(\"\");\r\n  const [passwordError, setPasswordError] = useState(\"\");\r\n  const [alert, setAlert] = useState(\"\");\r\n  const [alertTimeOut, setAlertTimeOut] = useState();\r\n  const [register] = useMutation(registerMutation);\r\n  const {\r\n    authContext: { isAuth },\r\n    dispatch: authDispatch\r\n  } = useContext(AuthContext);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    if (isAuth) {\r\n      router.push(\"/articles\");\r\n    }\r\n  }, [isAuth]);\r\n\r\n  // Clear timeout after unmount\r\n  useEffect(() => clearTimeout(alertTimeOut));\r\n\r\n  const handleValidateEmail = email => {\r\n    const re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    if (!re.test(email)) {\r\n      return setEmailError(\"Email must have @ and .\");\r\n    }\r\n    // No error\r\n    setEmailError(\"\");\r\n  };\r\n\r\n  const handleValidatePassword = password => {\r\n    if (password.length < 3) {\r\n      return setPasswordError(\"Password must have at least 3 chars\");\r\n    }\r\n    // No error\r\n    setPasswordError(\"\");\r\n  };\r\n\r\n  const showAlert = msg => {\r\n    setAlert(msg);\r\n\r\n    // Clear alert\r\n    setTimeout(() => {\r\n      setAlert(\"\");\r\n    }, 5000);\r\n  };\r\n\r\n  const handleChange = ({ target: { value, name } }) => {\r\n    switch (name) {\r\n      case \"email\":\r\n        handleValidateEmail(value);\r\n        return setEmail(value);\r\n      case \"password\":\r\n        handleValidatePassword(value);\r\n        return setPassword(value);\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n    try {\r\n      const { data } = await register({ variables: { email, password } });\r\n      authDispatch({ type: \"REGISTER_SUCCESS\", payload: data.register });\r\n      console.log(data);\r\n    } catch (err) {\r\n      if (err.graphQLErrors) {\r\n        showAlert(err.graphQLErrors[0].message);\r\n      } else {\r\n        console.log(err);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Layout>\r\n      <div className=\"login-page container\">\r\n        <div className=\"login-page-container\">\r\n          <h1 className=\"login-page__title\">Register</h1>\r\n          <div className=\"login-page__info\">\r\n            To begin your journey with the New York Times Articles, please\r\n            authenticate yourself.\r\n          </div>\r\n          <form\r\n            onSubmit={e => {\r\n              handleSubmit(e);\r\n            }}\r\n            className=\"login-page__form\">\r\n            {alert ? (\r\n              <div className=\"login-alert\">\r\n                {alert}\r\n                <button onClick={() => setAlert(\"\")} className=\"alert-close\">\r\n                  <i className=\"fas fa-times\"></i>\r\n                </button>\r\n              </div>\r\n            ) : null}\r\n            <div className=\"form-control\">\r\n              <div className={`input-error ${emailError ? \"active\" : \"\"}`}>\r\n                {emailError}\r\n              </div>\r\n              <input\r\n                type=\"email\"\r\n                name=\"email\"\r\n                className=\"login-form__input\"\r\n                value={email}\r\n                onChange={handleChange}\r\n                placeholder=\"Email...\"\r\n              />\r\n            </div>\r\n            <div className=\"form-control\">\r\n              <div className={`input-error ${passwordError ? \"active\" : \"\"}`}>\r\n                {passwordError}\r\n              </div>\r\n              <input\r\n                type=\"password\"\r\n                name=\"password\"\r\n                value={password}\r\n                className=\"login-form__input\"\r\n                onChange={handleChange}\r\n                placeholder=\"Password...\"\r\n              />\r\n            </div>\r\n\r\n            <input\r\n              type=\"submit\"\r\n              disabled={passwordError || emailError ? true : false}\r\n              className=\"btn btn--submit\"\r\n              value=\"Create Account\"\r\n            />\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n"]},"metadata":{},"sourceType":"module"}